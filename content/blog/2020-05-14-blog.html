---
title: Blog - Applying Python in data science - Clustering
author: ''
date: '2020-05-15'
slug: blog
categories: []
tags: []
description: ''
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div class="figure">
<img src="/blog/2020-05-14-blog_files/Screen%20Shot%202020-05-15%20at%209.27.12%20PM.png" />

</div>
<div id="while-r-is-a-program-commonly-used-in-data-science-and-statistics-python-can-also-be-used-to-accomplish-similar-purposes.-various-data-manipulations-can-be-done-on-both-programs.-in-the-example-below-clustering-is-completed-using-r-and-python-on-the-iris-dataset.-in-r-clustering-was-done-using-kmeans." class="section level2">
<h2>While R is a program commonly used in data science and statistics, python can also be used to accomplish similar purposes. Various data manipulations can be done on both programs. In the example below, clustering is completed using R and python on the iris dataset. In R, clustering was done using kmeans.</h2>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✔ ggplot2 3.2.1     ✔ purrr   0.3.3
## ✔ tibble  2.1.3     ✔ dplyr   0.8.3
## ✔ tidyr   1.0.0     ✔ stringr 1.4.0
## ✔ readr   1.3.1     ✔ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(cluster)
kmeans&lt;-iris%&gt;%select(-Species)%&gt;%kmeans(3)
kmeans</code></pre>
<pre><code>## K-means clustering with 3 clusters of sizes 96, 33, 21
## 
## Cluster means:
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1     6.314583    2.895833     4.973958   1.7031250
## 2     5.175758    3.624242     1.472727   0.2727273
## 3     4.738095    2.904762     1.790476   0.3523810
## 
## Clustering vector:
##   [1] 2 3 3 3 2 2 2 2 3 3 2 2 3 3 2 2 2 2 2 2 2 2 2 2 3 3 2 2 2 3 3 2 2 2 3 2 2
##  [38] 2 3 2 2 3 3 2 2 3 2 3 2 2 1 1 1 1 1 1 1 3 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 1 1 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1
## [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [149] 1 1
## 
## Within cluster sum of squares by cluster:
## [1] 118.651875   6.432121  17.669524
##  (between_SS / total_SS =  79.0 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<div id="in-python-the-kmeans-function-allows-for-clustering-and-assignment-of-the-data-points-into-three-clusters-similar-to-what-was-done-in-r.-in-python-the-clusters-are-012-which-is-similar-to-the-clusters-in-r-123.-python-can-also-calculate-the-cluster-means-using-.cluster_centers_." class="section level3">
<h3>In python, the kmeans function allows for clustering and assignment of the data points into three clusters, similar to what was done in R. In python, the clusters are (0,1,2), which is similar to the clusters in R (1,2,3). Python can also calculate the cluster means using .cluster_centers_.</h3>
<pre class="python"><code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.cluster import KMeans

iris = datasets.load_iris()
x=iris.data
y=iris.target

kmeans = KMeans(n_clusters=3)
y_kmeans = kmeans.fit_predict(x)
print(y_kmeans)</code></pre>
<pre><code>## [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 2 2 2 2 0 2 2 2 2
##  2 2 0 0 2 2 2 2 0 2 0 2 0 2 2 0 0 2 2 2 2 2 0 2 2 2 2 0 2 2 2 0 2 2 2 0 2
##  2 0]</code></pre>
<pre class="python"><code>abc = kmeans.cluster_centers_
print(abc)
</code></pre>
<pre><code>## [[ 5.9016129   2.7483871   4.39354839  1.43387097]
##  [ 5.006       3.418       1.464       0.244     ]
##  [ 6.85        3.07368421  5.74210526  2.07105263]]</code></pre>
</div>
<div id="below-i-created-four-clusters-using-kmeans-on-the-iris-dataset.-in-comparison-using-three-clusters-would-provide-better-visualization-because-cluster-four-and-three-are-not-as-abundant-as-cluster-one-and-two." class="section level3">
<h3>Below I created four clusters, using kmeans, on the iris dataset. In comparison, using three clusters would provide better visualization because cluster four and three are not as abundant as cluster one and two.</h3>
<pre class="r"><code>kmeans1&lt;-iris%&gt;%select(-Species)%&gt;%kmeans(4)
kmeans1</code></pre>
<pre><code>## K-means clustering with 4 clusters of sizes 17, 33, 62, 38
## 
## Cluster means:
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1     5.370588    3.800000     1.517647   0.2764706
## 2     4.818182    3.236364     1.433333   0.2303030
## 3     5.901613    2.748387     4.393548   1.4338710
## 4     6.850000    3.073684     5.742105   2.0710526
## 
## Clustering vector:
##   [1] 2 2 2 2 2 1 2 2 2 2 1 2 2 2 1 1 1 2 1 1 1 1 2 2 2 2 2 1 2 2 2 1 1 1 2 2 1
##  [38] 2 2 2 2 2 2 2 1 2 1 2 1 2 3 3 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
##  [75] 3 3 3 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 4 4 4 4 3 4 4 4 4
## [112] 4 4 3 3 4 4 4 4 3 4 3 4 3 4 4 3 3 4 4 4 4 4 3 4 4 4 4 3 4 4 4 3 4 4 4 3 4
## [149] 4 3
## 
## Within cluster sum of squares by cluster:
## [1]  2.630588  5.428485 39.820968 23.879474
##  (between_SS / total_SS =  89.5 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<pre class="python"><code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.cluster import KMeans

iris = datasets.load_iris()
x=iris.data
y=iris.target

kmeans = KMeans(n_clusters=4)
y_kmeans = kmeans.fit_predict(x)
print(y_kmeans)</code></pre>
<pre><code>## [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 2 1 2 1 2 1 2 2 2 2 1 2 1 2 2 1 2 1 2 1 1
##  1 1 1 1 1 2 2 2 2 1 2 1 1 1 2 2 2 1 2 2 2 2 2 1 2 2 3 1 3 3 3 3 2 3 3 3 1
##  1 3 1 1 3 3 3 3 1 3 1 3 1 3 3 1 1 3 3 3 3 3 1 1 3 3 3 1 3 3 3 1 3 3 3 1 1
##  3 1]</code></pre>
<pre class="python"><code>abc = kmeans.cluster_centers_
print(abc)</code></pre>
<pre><code>## [[ 5.006       3.418       1.464       0.244     ]
##  [ 6.2525      2.855       4.815       1.625     ]
##  [ 5.53214286  2.63571429  3.96071429  1.22857143]
##  [ 6.9125      3.1         5.846875    2.13125   ]]</code></pre>
</div>
<div id="in-the-r-code-below-i-graphed-the-three-clusters-based-on-all-four-variables-sepal-width-sepal-length-petal-length-petal-width.-in-the-python-i-graphed-the-three-clusters-based-on-only-sepal-width-and-sepal-length." class="section level3">
<h3>In the R code below, I graphed the three clusters based on all four variables (sepal width, sepal length, petal length, petal width). In the python, I graphed the three clusters based on only sepal width and sepal length.</h3>
<pre class="r"><code>library(GGally)</code></pre>
<pre><code>## 
## Attaching package: &#39;GGally&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     nasa</code></pre>
<pre class="r"><code>library(plotly) </code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>final &lt;- iris %&gt;% mutate(cluster = as.factor(kmeans$cluster))
final %&gt;% plot_ly(x =  ~Sepal.Width,  y =  ~Petal.Length,  z =  ~Petal.Width,  color =  ~cluster, 
    type =  &quot;scatter3d&quot;,  mode =  &quot;markers&quot;,  symbol =  ~Species,  symbols =  c(&#39;circle&#39;, &#39;x&#39;, &#39;o&#39;))</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"632e131eb636":["function () ","plotlyVisDat"]},"cur_data":"632e131eb636","attrs":{"632e131eb636":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"symbol":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"symbols":["circle","x","o"],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Sepal.Width"},"yaxis":{"title":"Petal.Length"},"zaxis":{"title":"Petal.Width"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.9,2.7,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.7,3,2.9,2.9,2.8],"y":[4.7,4.5,4.9,4,4.6,4.5,4.7,4.6,3.9,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,4.2,4.2,4.2,4.3,4.1],"z":[1.4,1.5,1.5,1.3,1.5,1.3,1.6,1.3,1.4,1.5,1,1.4,1.3,1.4,1.5,1,1.5,1.1,1.8,1.3,1.5,1.2,1.3,1.4,1.4,1.7,1.5,1,1.1,1,1.2,1.6,1.5,1.6,1.5,1.3,1.3,1.3,1.2,1.4,1.2,1.3,1.2,1.3,1.3,1.3],"mode":"markers","type":"scatter3d","name":"1<br />versicolor","marker":{"color":"rgba(102,194,165,1)","symbol":"x","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"y":[6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],"z":[2.5,1.9,2.1,1.8,2.2,2.1,1.7,1.8,1.8,2.5,2,1.9,2.1,2,2.4,2.3,1.8,2.2,2.3,1.5,2.3,2,2,1.8,2.1,1.8,1.8,1.8,2.1,1.6,1.9,2,2.2,1.5,1.4,2.3,2.4,1.8,1.8,2.1,2.4,2.3,1.9,2.3,2.5,2.3,1.9,2,2.3,1.8],"mode":"markers","type":"scatter3d","name":"1<br />virginica","marker":{"color":"rgba(102,194,165,1)","symbol":"circle-open","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[3.5,3.6,3.9,3.4,3.4,3.7,3.4,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3.5,3.4,3.4,4.1,4.2,3.2,3.5,3.6,3.4,3.5,3.5,3.8,3.8,3.7,3.3],"y":[1.4,1.4,1.7,1.4,1.5,1.5,1.6,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.6,1.5,1.4,1.5,1.5,1.4,1.2,1.3,1.4,1.5,1.3,1.6,1.9,1.6,1.5,1.4],"z":[0.2,0.2,0.4,0.3,0.2,0.2,0.2,0.2,0.4,0.4,0.3,0.3,0.3,0.2,0.4,0.2,0.5,0.4,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.1,0.2,0.3,0.6,0.4,0.2,0.2,0.2],"mode":"markers","type":"scatter3d","name":"2<br />setosa","marker":{"color":"rgba(252,141,98,1)","symbol":"circle","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[3,3.2,3.1,2.9,3.1,3,3,3.4,3,3.2,3.1,3.1,3,2.3,3.2,3,3.2],"y":[1.4,1.3,1.5,1.4,1.5,1.4,1.1,1.9,1.6,1.6,1.6,1.5,1.3,1.3,1.3,1.4,1.4],"z":[0.2,0.2,0.2,0.2,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.2,0.3,0.2],"mode":"markers","type":"scatter3d","name":"3<br />setosa","marker":{"color":"rgba(141,160,203,1)","symbol":"circle","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null},{"x":[2.4,2,2.3,2.5],"y":[3.3,3.5,3.3,3],"z":[1,1,1,1.1],"mode":"markers","type":"scatter3d","name":"3<br />versicolor","marker":{"color":"rgba(141,160,203,1)","symbol":"x","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggpairs(final, columns=1:4, aes(color=Species))</code></pre>
<p><img src="/blog/2020-05-14-blog_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<div class="figure">
<img src="/blog/2020-05-14-blog_files/Screen%20Shot%202020-05-15%20at%205.52.44%20PM.png" />

</div>
</div>
<div id="in-conclusion-the-following-examples-demonstrate-that-r-and-python-can-both-cluster-and-plot-data." class="section level3">
<h3>In conclusion, the following examples demonstrate that R and python can both cluster and plot data.</h3>
</div>
</div>
